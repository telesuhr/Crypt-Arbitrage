# Discord通知設定ガイド（初心者向け）

このガイドでは、Discordを初めて使う方向けに、アービトラージ通知を受け取るための設定方法を詳しく説明します。

## 📱 Step 1: Discordアカウント作成

### 1.1 iPhoneでDiscordアプリをダウンロード
1. App Storeで「Discord」を検索
2. 「Discord」アプリ（紫色のアイコン）をダウンロード
3. インストール完了後、アプリを開く

### 1.2 アカウント作成
1. 「登録」をタップ
2. メールアドレスを入力
3. ユーザー名を設定（例：crypto_trader_2024）
4. パスワードを設定
5. 生年月日を入力
6. 「アカウント作成」をタップ
7. メール認証を完了

### 1.3 初期設定
1. プロフィール設定（任意）
2. 通知設定で「プッシュ通知を許可」をタップ
3. 位置情報は「許可しない」でOK

## 🖥️ Step 2: PCでサーバー作成（簡単）

### 2.1 Webブラウザでアクセス
1. PCのブラウザで https://discord.com/ にアクセス
2. 「ブラウザでDiscordを開く」をクリック
3. 作成したアカウントでログイン

### 2.2 サーバー作成
1. 左側の「+」ボタンをクリック
2. 「サーバーを作成」を選択
3. 「自分用」を選択
4. サーバー名を入力（例：「仮想通貨Bot」）
5. 「作成」をクリック

### 2.3 チャンネル作成
1. 「一般」チャンネルを右クリック
2. 「チャンネルを編集」→「チャンネルを削除」（不要なため）
3. カテゴリ「テキストチャンネル」の「+」をクリック
4. チャンネル名：「arbitrage-alerts」
5. 「チャンネルを作成」をクリック

## ⚙️ Step 3: ウェブフック設定

### 3.1 ウェブフック作成
1. 「arbitrage-alerts」チャンネルの設定（歯車マーク）をクリック
2. 左メニューから「連携サービス」をクリック
3. 「ウェブフック」をクリック
4. 「新しいウェブフック」をクリック

### 3.2 ウェブフック設定
1. **名前**: 「仮想通貨アービトラージBot」
2. **チャンネル**: 「arbitrage-alerts」が選択されていることを確認
3. **アバター**: デフォルトのままでOK
4. 「変更を保存」をクリック

### 3.3 ウェブフックURL取得
1. 作成したウェブフックをクリック
2. 「ウェブフックURLをコピー」をクリック
3. URLをコピー（重要：このURLは誰にも教えない）

URL例：
```
https://discord.com/api/webhooks/1234567890123456789/ABCdefGHIjklMNOpqrSTUvwxYZ1234567890abcdefghijklmnopqrstuvwxyz
```

## 📋 Step 4: プロジェクト設定

### 4.1 .envファイル編集
1. プロジェクトの`.env`ファイルを開く
2. 以下の行を追加または編集：

```bash
# Discord Webhook (推奨)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_URL_HERE
```

3. `YOUR_WEBHOOK_URL_HERE` の部分を、Step 3.3でコピーしたURLに置き換え
4. ファイルを保存

### 4.2 設定確認
```bash
# 通知設定確認
python scripts/manage_notifications.py --show

# Discord通知テスト
python scripts/test_discord_notify.py
```

## 📱 Step 5: iPhone通知設定

### 5.1 サーバー参加
1. iPhoneのDiscordアプリを開く
2. 左上のメニュー（≡）をタップ
3. 作成したサーバー「仮想通貨Bot」が表示される
4. タップしてサーバーに入る

### 5.2 プッシュ通知設定
1. 右上のユーザーアイコンをタップ
2. 「設定」（歯車マーク）をタップ
3. 「通知」をタップ
4. 「プッシュ通知」をオンにする

### 5.3 サーバー通知設定
1. サーバー「仮想通貨Bot」に入る
2. サーバー名をタップ
3. 「通知設定」をタップ
4. 以下を設定：
   - **すべてのメッセージ**: オン
   - **モバイルプッシュ通知**: オン
   - **arbitrage-alertsチャンネル**: オン（個別設定）

## 🧪 Step 6: テスト実行

### 6.1 基本テスト
```bash
# 基本接続テスト
python scripts/test_discord_notify.py
```

### 6.2 iPhone確認
1. テスト実行後、iPhoneに通知が来ることを確認
2. Discordアプリで「arbitrage-alerts」チャンネルにメッセージが表示されることを確認

### 6.3 各種テスト
```bash
# アービトラージ通知テスト
python scripts/manage_notifications.py --test

# 設定確認
python scripts/manage_notifications.py --show
```

## 🔧 トラブルシューティング

### 問題1: 通知が送信されない
**確認項目:**
- ウェブフックURLが正しく設定されているか
- インターネット接続があるか
- ウェブフックが削除されていないか

**解決方法:**
```bash
# エラー詳細を確認
python scripts/test_discord_notify.py
```

### 問題2: iPhone通知が来ない
**確認項目:**
- Discordアプリがインストールされているか
- プッシュ通知が有効になっているか
- サーバー通知設定が正しいか
- iPhoneの「設定」→「通知」→「Discord」で通知が許可されているか

**解決方法:**
1. iPhoneの設定を再確認
2. Discordアプリを再起動
3. テスト通知を再送信

### 問題3: 通知が多すぎる
**設定変更:**
```bash
# 利益率閾値を上げる（例：0.1%以上）
python scripts/manage_notifications.py --threshold 0.1

# 静寂時間を設定（夜間通知停止）
python scripts/manage_notifications.py --quiet 23:00 07:00
```

## 📊 実際の運用

### 基本的な使い方
1. データ収集を開始
```bash
python src/main.py collect
```

2. アービトラージ分析を開始
```bash
python src/main.py analyze
```

3. リアルタイム監視開始
```bash
python scripts/monitor_arbitrage.py
```

### 通知の見方
Discord通知には以下の情報が含まれます：
- **利益率**: パーセンテージ
- **予想利益**: 円単位
- **通貨ペア**: BTC/JPY等
- **買い取引所**: 安く買える取引所と価格
- **売り取引所**: 高く売れる取引所と価格
- **検出時刻**: 機会を発見した時刻

### 注意事項
⚠️ **重要**: 通知は機会の検出のみで、実際の取引は行いません
⚠️ **リスク**: 価格変動、送金時間、手数料を考慮して判断してください
⚠️ **セキュリティ**: ウェブフックURLは第三者に教えないでください

## 🎯 完了チェックリスト

- [ ] Discordアカウント作成
- [ ] サーバー「仮想通貨Bot」作成
- [ ] チャンネル「arbitrage-alerts」作成
- [ ] ウェブフック作成・URL取得
- [ ] .envファイルにURL設定
- [ ] iPhone Discordアプリインストール
- [ ] iPhone通知設定完了
- [ ] テスト通知成功
- [ ] 実際のアービトラージ監視開始

すべて完了したら、iPhoneでリアルタイムにアービトラージ機会を受け取れます！

## 💡 追加のTips

### サーバーの整理
- 複数の通知チャンネルを作成可能（例：「high-profit」「system-alerts」）
- チャンネルごとに通知設定を変更可能

### セキュリティ
- サーバーを「プライベート」に設定
- 招待リンクは作成しない
- ウェブフックURLは秘密に保つ

### カスタマイズ
- ウェブフックの名前やアバターを変更可能
- 複数のウェブフックで用途別に分けることも可能